<!DOCTYPE html>
<html lang="hu">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üèì Ping-Pong Jelentkez√©s</title>
    <style>
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #1e5799 0%,#2989d8 50%,#7db9e8 100%); display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; color: #333; }
        .container { background: white; padding: 30px; border-radius: 20px; box-shadow: 0 15px 35px rgba(0,0,0,0.2); width: 90%; max-width: 400px; text-align: center; }
        h1 { color: #0056b3; margin-bottom: 5px; }
        p.subtitle { color: #666; margin-bottom: 25px; font-size: 14px; }
        input, select, button { width: 100%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 2px solid #eee; font-size: 16px; transition: 0.3s; box-sizing: border-box; }
        input:focus, select:focus { border-color: #0056b3; outline: none; }
        button { background: #28a745; color: white; border: none; font-weight: bold; cursor: pointer; margin-top: 20px; text-transform: uppercase; letter-spacing: 1px; }
        button:hover { background: #218838; transform: translateY(-2px); }
        button:active { transform: translateY(0); }
        #status { font-weight: bold; margin-top: 15px; min-height: 20px; }
        .success { color: #28a745; }
        .error { color: #dc3545; }
    </style>
</head>
<body>

<div class="container">
    <h1>üèì Ping-Pong</h1>
    <p class="subtitle">V√°lassz id≈ëpontot √©s gyere edzeni!</p>
    
    <input type="text" id="name" placeholder="√çrd be a neved..." required>
    
    <select id="date">
        <option value="">-- Melyik edz√©sre j√∂ssz? --</option>
        <option id="opt1"></option>
        <option id="opt2"></option>
        <option id="opt3"></option>
        <option id="opt4"></option>
    </select>

    <button onclick="sendData()" id="submitBtn">Ott leszek!</button>
    <div id="status"></div>
</div>

<script>
    // K√∂vetkez≈ë 4 edz√©snap gener√°l√°sa (Kedd, Cs√ºt, Vas)
    function generateDates() {
        let dates = [];
        let d = new Date();
        while(dates.length < 4) {
            d.setDate(d.getDate() + 1);
            let day = d.getDay();
            if(day === 2 || day === 4 || day === 0) { 
                let options = { month: 'short', day: 'numeric', weekday: 'short' };
                let dateStr = d.toLocaleDateString('hu-HU', options);
                let timeStr = (day === 0) ? "9:00 - 12:00" : "19:00 - 21:00";
                let finalLabel = dateStr + " | " + timeStr;
                dates.push(finalLabel);
            }
        }
        for(let i=1; i<=4; i++) {
            let el = document.getElementById('opt'+i);
            el.innerText = dates[i-1];
            el.value = dates[i-1];
        }
    }
    generateDates();

    function sendData() {
        const name = document.getElementById('name').value;
        const date = document.getElementById('date').value;
        const status = document.getElementById('status');
        const btn = document.getElementById('submitBtn');

        if(!name || !date) {
            status.innerText = "‚ùå T√∂lts ki mindent!";
            status.className = "error";
            return;
        }

        btn.disabled = true;
        status.innerText = "‚è≥ K√ºld√©s folyamatban...";
        status.className = "";
        
        function doPost(e) {
  try {
    // A honlapr√≥l √©rkez≈ë adatok feldolgoz√°sa
    var data = JSON.parse(e.postData.contents);
    var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
    
    // √öj sor hozz√°ad√°sa a t√°bl√°zathoz: 
    // Id≈ëb√©lyeg | N√©v | V√°lasztott id≈ëpont
    sheet.appendRow([new Date(), data.n√©v, data.id≈ëpont]);
    
    return ContentService.createTextOutput("Sikeres ment√©s")
      .setMimeType(ContentService.MimeType.TEXT);
      
  } catch (error) {
    // Hiba eset√©n visszajelz√©s
    return ContentService.createTextOutput("Hiba: " + error.toString())
      .setMimeType(ContentService.MimeType.TEXT);
  }
}

// Ez a r√©sz csak az√©rt kell, hogy a b√∂ng√©sz≈ë ne dobjon hib√°t a k√ºld√©skor
function doOptions(e) {
  return ContentService.createTextOutput("")
    .setMimeType(ContentService.MimeType.TEXT);
}

        fetch(url, {
            method: "POST",
            mode: "no-cors",
            cache: "no-cache",
            body: JSON.stringify({ n√©v: name, id≈ëpont: date })
        }).then(() => {
            status.innerText = "‚úÖ Siker! Be√≠rtalak az edz√©sre.";
            status.className = "success";
            document.getElementById('name').value = "";
            btn.disabled = false;
        }).catch(e => {
            status.innerText = "‚ùå Hiba t√∂rt√©nt a k√ºld√©skor!";
            status.className = "error";
            btn.disabled = false;
        });
    }
</script>

</body>
</html>
