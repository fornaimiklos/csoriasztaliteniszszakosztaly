/**
 * Google Apps Script - Teljes kód az Edzés Jelentkezéshez
 * Ez a kód az A1 cellától olvassa a dátumokat.
 */

function doGet() {
  // Megjeleníti az index.html oldalt (vagy amit a weboldalad használ)
  return HtmlService.createTemplateFromFile('index')
      .evaluate()
      .setTitle('Edzés Jelentkezés')
      .addMetaTag('viewport', 'width=device-width, initial-scale=1')
      .setXFrameOptionsMode(HtmlService.XFrameOptionsMode.ALLOWALL);
}

// EZ A FÜGGVÉNY OLVASSA BE A DÁTUMOKAT A TÁBLÁZATBÓL
function getDatesFromSheet() {
  try {
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = ss.getSheets()[0]; // Az első munkalapot olvassa
    
    // Lekérjük az összes adatot az A oszlopból az 1. sortól kezdve
    var lastRow = sheet.getLastRow();
    if (lastRow < 1) return ["Nincs elérhető időpont"];
    
    var range = sheet.getRange(1, 1, lastRow, 1);
    var values = range.getValues();
    var dates = [];
    
    for (var i = 0; i < values.length; i++) {
      var val = values[i][0].toString().trim();
      if (val !== "") {
        dates.push(val);
      }
    }
    return dates;
  } catch (e) {
    return ["Hiba: " + e.toString()];
  }
}

// EZ A FÜGGVÉNY MENTI EL A JELENTKEZŐT
function processForm(formData) {
  try {
    var ss = SpreadsheetApp.getActiveSpreadsheet();
    // Megkeresi a 'Jelentkezők' fület, ha nincs, létrehozza vagy az elsőre ír
    var sheet = ss.getSheetByName("Jelentkezők") || ss.getSheets()[0];
    
    sheet.appendRow([
      new Date(), // Időbélyeg
      formData.nev, 
      formData.idopont
    ]);
    
    return "SIKER";
  } catch (e) {
    return "HIBA: " + e.toString();
  }
}
